data <- read.csv("stock_data_clean.csv")
data <- read.csv("./stock_data_clean.csv")
data <- read.csv("./stock_screening/stock_data_clean.csv")
View(data)
library(tidyverse)
(127-132)/132
install.packages("gridExtra")
g2 =  stock %>%
ggplot(aes(x = ROE_5Y, y = Median_Q_Growth))+
geom_point(alpha = 0.1)+
geom_smooth(method = lm)+
scale_x_continuous("Return on Equity (past 5 years mean)",limits = c(-0.25 ,0.5))+
scale_y_continuous("Price growth rate",limits = c(-0.5, 1))+
ggtitle("Price Growth v.s. Return on Equity")
g3 =  stock %>%
ggplot(aes(x = DEratio_5Y, y = Median_Q_Growth))+
geom_point(alpha = 0.1)+
geom_smooth(method = lm)+
scale_x_continuous("Debt to equity ratio (past 5 years mean)",limits = c(-0.25 , 3))+
scale_y_continuous("Price growth rate", limits = c(-0.5, 1))+
ggtitle("Price Growth v.s. Debt to Equity Ratio")
g4 =  stock %>%
ggplot(aes(x = Profit_Margin_5Y, y = Median_Q_Growth))+
geom_point(alpha = 0.1)+
geom_smooth(method = lm)+
scale_x_continuous("Profit margin (past 5 years mean)",limits = c(-0.2 , 0.4))+
scale_y_continuous("Price growth rate", limits = c(-0.5, 1))+
ggtitle("Price Growth v.s. Profit Margin")
g5 = stock %>%
ggplot(aes(x = PEratio, y = Median_Q_Growth))+
geom_point(alpha = 0.1)+
geom_smooth(method = lm)+
scale_x_continuous("Price to earning ratio",limits = c(0 , 40))+
scale_y_continuous("Price growth rate", limits = c(-0.5, 1))+
ggtitle("Price Growth v.s. Price to Earning Ratio")
shiny::runApp('stock_screening')
runApp('stock_screening')
runApp('stock_screening')
setwd("C:/Users/User/Dropbox/amds4/532visual2/labs/stock_screening")
runApp('stock_screening')
library(shiny)
library(ggplot2)
library(gridExtra)
install.packages("gridExtra")
library(gridExtra)
runApp('stock_screening')
runApp('stock_screening')
runApp('stock_screening')
runApp('stock_screening')
?geom_smooth
runApp('stock_screening')
runApp('stock_screening')
runApp('stock_screening')
runApp('stock_screening')
runApp('stock_screening')
runApp('stock_screening')
runApp('stock_screening')
g2 =  stock %>%
ggplot(aes(x = ROE_5Y, y = Median_Q_Growth))+
geom_histogram(alpha = 0.1)
scale_x_continuous("Return on Equity (past 5 years mean)",limits = c(-0.25 ,0.5))+
scale_y_continuous("Counts")+
ggtitle("Return on Equity")
g2 =  stock %>%
ggplot(aes(x = ROE_5Y, y = Median_Q_Growth))+
geom_histogram(alpha = 0.1)
stock <- read.csv("./stock_data_clean.csv")
stock <- read.csv("./stock_screening//stock_data_clean.csv")
g2 =  stock %>%
ggplot(aes(x = ROE_5Y, y = Median_Q_Growth))+
geom_histogram(alpha = 0.1)
g2
g2 =  stock %>%
ggplot(aes(x = ROE_5Y))+
geom_histogram(alpha = 0.1)
g2
stock %>%
ggplot(aes(x = ROE_5Y))+
geom_histogram()
# data filtering, remove outliers
stock <- filter(stock, stock$ROE_5Y<0.5,
stock$ROE_5Y> -0.25,
stock$DEratio_5Y>-0.5,
stock$DEratio_5Y<3,
stock$PEratio > 0,
stock$PEratio < 40,
stock$Profit_Margin_5Y >-0.2,
stock$Profit_Margin_5Y < 0.4)
stock %>%
ggplot(aes(x = ROE_5Y))+
geom_histogram()
stock %>%
ggplot(aes(x = ROE_5Y))+
geom_histogram(color = "black", fill = "darkgreen")+
scale_x_continuous("Return on Equity (past 5 years mean)",limits = c(-0.25 ,0.5))+
scale_y_continuous("Counts")+
ggtitle("Return on Equity")
stock %>%
ggplot(aes(x = ROE_5Y))+
geom_histogram(color = "white", fill = "darkgreen")+
scale_x_continuous("Return on Equity (past 5 years mean)",limits = c(-0.25 ,0.5))+
scale_y_continuous("Counts")+
ggtitle("Return on Equity")
runApp('stock_screening')
runApp('stock_screening')
runApp('stock_screening')
runApp('stock_screening')
stock
View(stock)
stock %>% group_by(Year) %>% summarise(mean(Median_Q_Growth))
stock %>% group_by(Year) %>% summarise(growth = mean(Median_Q_Growth))
stock %>% group_by(Year) %>% summarise(growth = mean(Median_Q_Growth), investment = cumprod(growth+1)*10000)
stock %>% group_by(Year) %>% summarise(growth = mean(Median_Q_Growth)()
d
stock %>% group_by(Year) %>% summarise(growth = mean(Median_Q_Growth))
tmp <- stock %>% group_by(Year) %>% summarise(growth = mean(Median_Q_Growth))
shiny::runApp('stock_screening')
runApp('stock_screening')
